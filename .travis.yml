sudo: required

language: node_js

node_js:
    - "14"

dist:
    - "bionic"

addons:
    apt:
        packages:
            - rabbitmq-server
services:
    - mongodb
    - redis-server
    - rabbitmq

script:
    - npm install --no-cache
    - npm i -g pm2
    - pm2 install typescript
    - pm2 start pm2.deploy.json
    - pm2 logs
    - echo "test"
    - sleep 10
    - curl http://localhost:4263/rest/v1
    - sudo pm2 stop all
    - sudo pm2 delete all
